<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è¬ç”¨ä½œæ–‡æ¨¡æ¿ï¼šé›™åœ–å°æ¯”ç‰ˆ</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-XXXXXXXXXX');
    </script>

    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; -webkit-tap-highlight-color: transparent; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .animate-slide-up { animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .animate-fade-in { animation: fadeIn 0.2s ease-out forwards; }
    </style>
</head>
<body class="bg-[#F7F7F5] text-[#37352F] h-[100dvh] overflow-hidden">
    
    <div id="error-display" style="display:none; padding: 20px; color: red; background: #ffe6e6; border: 1px solid red; margin: 20px;"></div>
    
    <div id="root" class="h-full"></div>

    <script>
        window.onerror = function(message) {
            document.getElementById('error-display').style.display = 'block';
            document.getElementById('error-display').innerHTML = '<h3>âš ï¸ éŒ¯èª¤</h3><p>' + message + '</p>';
        };
    </script>

    <script type="text/babel">
        try {
            const { useState, useEffect, useRef } = React;
            // --- ICONS ---
            const Icons = {
                Book: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>,
                FileText: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>,
                Play: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>,
                Pause: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>,
                Square: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/></svg>,
                Eye: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>,
                X: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
                ToggleLeft: () => <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#9CA3AF" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="1" y="5" width="22" height="14" rx="7" ry="7"/><circle cx="8" cy="12" r="3"/></svg>,
                ToggleRight: () => <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#EB5757" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="1" y="5" width="22" height="14" rx="7" ry="7"/><circle cx="16" cy="12" r="3"/></svg>,
                Translate: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 8l6 6"/><path d="M4 14h6"/><path d="M2 5h12"/><path d="M7 2v3"/><path d="M22 22l-5-10-5 10"/><path d="M14 18h6"/></svg>,
                ChevronDown: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 9l6 6 6-6"/></svg>,
                ChevronUp: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 15l-6-6-6 6"/></svg>
            };

            // --- VOCAB DB ---
            const VOCAB_DB = {
                "juxtaposition": { kk: "[ÍµdÊ’ÊŒkstÉ™pÉ™Ë‹zÉªÊƒÉ™n]", pos: "n.", def: "ä¸¦åˆ—ï¼›å°ç…§", ex: "The juxtaposition of wealth and poverty is striking." },
                "multifaceted": { kk: "[ÍµmÊŒltÉªË‹fÃ¦sÉªtÉªd]", pos: "adj.", def: "å¤šé¢å‘çš„", ex: "This is a multifaceted problem." },
                "spectrum": { kk: "[Ë‹spÉ›ktrÉ™m]", pos: "n.", def: "å…‰è­œï¼›ç¯„åœ", ex: "The two views are at opposite ends of the spectrum." },
                "captures": { kk: "[Ë‹kÃ¦ptÊƒÉšz]", pos: "v.", def: "æ•æ‰ï¼›åˆ»ç•«", ex: "The photo captures the joy of the moment." },
                "observe": { kk: "[É™bË‹zÉv]", pos: "v.", def: "è§€å¯Ÿ", ex: "We can observe changes in the weather." },
                "characterized": { kk: "[Ë‹kÃ¦rÉ™ktÉ™ÍµraÉªzd]", pos: "v.", def: "å…·æœ‰...ç‰¹å¾µ", ex: "The era was characterized by rapid change." },
                "emphasizing": { kk: "[Ë‹É›mfÉ™ÍµsaÉªzÉªÅ‹]", pos: "v.", def: "å¼·èª¿", ex: "He is emphasizing the importance of safety." },
                "scenarios": { kk: "[sÉªË‹nÃ¦rÉªÍµoz]", pos: "n.", def: "æƒ…å¢ƒï¼›å ´æ™¯", ex: "We planned for several possible scenarios." },
                "contrast": { kk: "[Ë‹kÉ‘ntrÃ¦st]", pos: "n.", def: "å°æ¯”ï¼›å·®ç•°", ex: "The contrast between the two colors is sharp." },
                "reflecting": { kk: "[rÉªË‹flÉ›ktÉªÅ‹]", pos: "v.", def: "åæ€ï¼›åæ˜ ", ex: "I spent time reflecting on my decision." },
                "depictions": { kk: "[dÉªË‹pÉªkÊƒÉ™nz]", pos: "n.", def: "æç¹ª", ex: "The book contains vivid depictions of war." },
                "gravitating": { kk: "[Ë‹grÃ¦vÉ™ÍµtetÉªÅ‹]", pos: "v.", def: "è¢«å¸å¼•ï¼›å‚¾å‘", ex: "Most people are gravitating towards the city." },
                "represents": { kk: "[ÍµrÉ›prÉªË‹zÉ›nts]", pos: "v.", def: "ä»£è¡¨", ex: "This flag represents our country." },
                "sanctuary": { kk: "[Ë‹sÃ¦Å‹ktÊƒÊŠÍµÉ›rÉª]", pos: "n.", def: "é¿é¢¨æ¸¯ï¼›è–æ‰€", ex: "My room is my sanctuary." },
                "merit": { kk: "[Ë‹mÉ›rÉªt]", pos: "n.", def: "å„ªé»ï¼›åƒ¹å€¼", ex: "There is some merit in your plan." },
                "pales": { kk: "[pelz]", pos: "v.", def: "ç›¸å½¢è¦‹çµ€ (pale in comparison)", ex: "Everything else pales in comparison to this." },
                "comparison": { kk: "[kÉ™mË‹pÃ¦rÉ™sn]", pos: "n.", def: "æ¯”è¼ƒ", ex: "By comparison, the second option is cheaper." },
                "essential": { kk: "[ÉªË‹sÉ›nÊƒÉ™l]", pos: "adj.", def: "æœ¬è³ªçš„ï¼›å¿…è¦çš„", ex: "Water is essential for life." },
                "priority": { kk: "[praÉªË‹É”rÉ™tÉª]", pos: "n.", def: "å„ªå…ˆäº‹é …", ex: "Safety is our top priority." },
                "undoubtedly": { kk: "[ÊŒnË‹daÊŠtÉªdlÉª]", pos: "adv.", def: "ç„¡ç–‘åœ°", ex: "He is undoubtedly the best player." },
                "artificial": { kk: "[ÍµÉ‘rtÉ™Ë‹fÉªÊƒÉ™l]", pos: "adj.", def: "äººå·¥çš„", ex: "The flowers are artificial but look real." },
                "facilities": { kk: "[fÉ™Ë‹sÉªlÉ™tÉªz]", pos: "n.", def: "è¨­æ–½", ex: "The hotel has excellent sports facilities." },
                "lively": { kk: "[Ë‹laÉªvlÉª]", pos: "adj.", def: "ç†±é¬§çš„ï¼›å……æ»¿æ´»åŠ›çš„", ex: "The market is very lively today." },
                "starkly": { kk: "[Ë‹stÉ‘rklÉª]", pos: "adv.", def: "æ˜é¡¯åœ°ï¼›åš´é…·åœ°", ex: "The reality contrasts starkly with the dream." },
                "evoking": { kk: "[ÉªË‹vokÉªÅ‹]", pos: "v.", def: "å–šèµ·", ex: "The smell evokes memories of childhood." },
                "atmosphere": { kk: "[Ë‹Ã¦tmÉ™sÍµfÉªr]", pos: "n.", def: "æ°£æ°›", ex: "The restaurant has a cozy atmosphere." },
                "dichotomy": { kk: "[daÉªË‹kÉ‘tÉ™mÉª]", pos: "n.", def: "äºŒåˆ†æ³•ï¼›å°ç«‹", ex: "There is a dichotomy between theory and practice." },
                "cautious": { kk: "[Ë‹kÉ”ÊƒÉ™s]", pos: "adj.", def: "è¬¹æ…çš„", ex: "He is cautious about spending money." },
                "relieving": { kk: "[rÉªË‹livÉªÅ‹]", pos: "v.", def: "ç·©è§£", ex: "Medicine is effective in relieving pain." },
                "shivering": { kk: "[Ë‹ÊƒÉªvÉ™rÉªÅ‹]", pos: "v.", def: "ç™¼æŠ–", ex: "He was shivering from the cold." },
                "empathy": { kk: "[Ë‹É›mpÉ™Î¸Éª]", pos: "n.", def: "åŒç†å¿ƒ", ex: "She felt great empathy for the victims." },
                "unnecessarily": { kk: "[ÊŒnË‹nÉ›sÉ™ÍµsÉ›rÉ™lÉª]", pos: "adv.", def: "ä¸å¿…è¦åœ°", ex: "Don't take risks unnecessarily." },
                "conversely": { kk: "[kÉ™nË‹vÉslÉª]", pos: "adv.", def: "ç›¸ååœ°", ex: "He loves sports; conversely, his brother hates them." },
                "serene": { kk: "[sÉ™Ë‹rin]", pos: "adj.", def: "å¯§éœçš„", ex: "The lake looked serene in the moonlight." },
                "tranquil": { kk: "[Ë‹trÃ¦Å‹kwÉªl]", pos: "adj.", def: "æ¬éœçš„", ex: "They live in a tranquil village." },
                "invigorating": { kk: "[ÉªnË‹vÉªgÉ™ÍµretÉªÅ‹]", pos: "adj.", def: "ç”Ÿæ°£å‹ƒå‹ƒçš„ï¼›ä»¤äººæŒ¯å¥®çš„", ex: "A morning run is invigorating." },
                "idyllic": { kk: "[aÉªË‹dÉªlÉªk]", pos: "adj.", def: "ç”°åœ’è©©èˆ¬çš„", ex: "It was an idyllic vacation." },
                "chaotic": { kk: "[keË‹É‘tÉªk]", pos: "adj.", def: "æ··äº‚çš„", ex: "The traffic in the city is chaotic." },
                "perilous": { kk: "[Ë‹pÉ›rÉ™lÉ™s]", pos: "adj.", def: "å±éšªçš„", ex: "The journey was perilous." },
                "hazardous": { kk: "[Ë‹hÃ¦zÉšdÉ™s]", pos: "adj.", def: "æœ‰å®³çš„ï¼›å†’éšªçš„", ex: "Chemicals can be hazardous to health." },
                "suffocating": { kk: "[Ë‹sÊŒfÉ™ÍµketÉªÅ‹]", pos: "adj.", def: "ä»¤äººçª’æ¯çš„", ex: "The heat was suffocating." },
                "convinced": { kk: "[kÉ™nË‹vÉªnst]", pos: "adj.", def: "ç¢ºä¿¡çš„", ex: "I am convinced that we will win." },
                "resonate": { kk: "[Ë‹rÉ›zÉ™Íµnet]", pos: "v.", def: "å…±é³´", ex: "Her speech resonated with the audience." },
                "indispensable": { kk: "[ÍµÉªndÉªsË‹pÉ›nsÉ™b!]", pos: "adj.", def: "ä¸å¯æˆ–ç¼ºçš„", ex: "Mobile phones have become indispensable." },
                "paramount": { kk: "[Ë‹pÃ¦rÉ™ÍµmaÊŠnt]", pos: "adj.", def: "è‡³é—œé‡è¦çš„", ex: "Safety is of paramount importance." },
                "pivotal": { kk: "[Ë‹pÉªvÉ™t!]", pos: "adj.", def: "é—œéµçš„", ex: "He played a pivotal role in the negotiations." }
            };

            const FOOTNOTE_DB = {
                1: ["artificial amusement", "enjoying a holiday"],
                2: ["natural serenity", "facing danger"],
                3: ["ideal park", "a typhoon day"],
                4: ["relaxation", "excitement"],
                5: ["a colorful playground full of children", "crowds of people lining up at a movie theater"],
                6: ["it's a perfect place for kids to play and have fun together", "many people treat the typhoon break simply as a bonus time to have fun"],
                7: ["tall trees and a simple walking path", "motorcyclists struggling against strong winds and heavy rain"],
                8: ["the relaxing power of nature", "how dangerous it is to be outside during the storm"],
                9: ["excitement vs. relaxation", "personal pleasure vs. public safety"],
                10: ["the peaceful forest shown in Image B", "the cautious attitude suggested by Picture B"],
                11: ["a park", "a typhoon day"],
                12: ["a place to exercise", "a free day off from school or work"],
                13: ["a sanctuary for resting my mind", "a measure to protect our lives"],
                14: ["playing on the swings", "going shopping or watching a movie"],
                15: ["mental health provided by nature", "staying safe indoors"],
                16: ["I felt extremely stressed after a difficult math exam. Instead of going to a noisy place, I took a walk in a quiet park nearby. The fresh air and the sound of birds quickly made me feel calm again.", 
                     "I ordered food delivery during a typhoon because I was lazy. When the delivery man arrived, he was soaking wet and shivering. I felt terrible because my convenience put him in danger."],
                17: ["public spaces", "government policy"],
                18: ["comfort and peace", "safety and empathy"],
                19: ["people can truly recharge their batteries", "no one gets hurt unnecessarily"]
            };

            const FORMULA_PARAGRAPHS = [
                `[P1]
The set of images presented offers a striking juxtaposition between åœ–1å…§å®¹(åè©)[1] and åœ–2å…§å®¹(åè©)[2], highlighting the multifaceted nature of å…©å¼µåœ–çš„å…±åŒä¸»é¡Œ(åè©)[3]. On one end of the spectrum, Image A captures a sense of æè¿°æ°›åœæˆ–æƒ…å¢ƒçš„åè©[4]. Here, we observe æ›´æ˜ç¢ºçš„ç´°ç¯€(åè©)[5], which suggests (that) è§£è®€æ­¤ç¾è±¡æˆ–æ°›åœçš„å¥å­[6]. Unlike the former, this scene is characterized by æè¿°åœ–Bçš„ç‰¹è‰²(åè©)[7], emphasizing åœ–Bå‚³é”çš„æ„ç¾©(åè©)[8]. The difference between these two scenarios is not merely visual but speaks to the deeper contrast of è¡¨é”å…©å¼µåœ–ç‰‡å„è‡ªä¸»é¡Œçš„åè©[9].`,
                
                `[P2]
Reflecting upon these distinct depictions, I find myself gravitating towards æŸå¼µåœ–ç‰‡ä¸­çš„æƒ…å¢ƒæˆ–åšæ³•[10]. To me, èˆ‡ä¸»é¡Œæœ‰é—œçš„åè©[11] represents more than just è¡¨é¢ä¸Šçš„æ„ç¾©[12]; it serves as æ·±å±¤çš„æ„ç¾©[13]. While å¦ä¸€å¼µåœ–çš„é¸æ“‡æˆ–åšæ³•[14] holds some merit, it pales in comparison to the essential value of ä½ é¸æ“‡è©²åœ–çš„ç†ç”±æˆ–å‹•æ©Ÿ[15]. For instance, I recall a moment when æˆ‘æŸæ™‚æŸåœ°å¦‚ä½•åšäº†ä½•äº‹(ç”¨å¤šå€‹å¥å­è©³ç´°æè¿°ä¸€å€‹ä¾‹å­)[16]. Ultimately, whether we are discussing èˆ‡ä¸»é¡Œæœ‰é—œçš„åè©[17] or personal choices, the priority should undoubtedly be placed on ä½ é¸æ“‡è©²åœ–çš„æ ¸å¿ƒåƒ¹å€¼è§€(åè©)[18], ensuring that æœ€ç†æƒ³çš„çµæœ[19].`
            ];

            const ESSAYS_DATA = [
                {
                    id: 1,
                    title: "ç¯„æ–‡ 1: Ideal Park",
                    prompt: "æç¤º: ä¸åŒçš„å…¬åœ’,å¯èƒ½æ¨£è²Œä¸åŒ,ç‰¹è‰²ä¹Ÿä¸åŒã€‚è«‹ä»¥æ­¤ç‚ºä¸»é¡Œ,ä¸¦ä¾æ“šä¸‹åˆ—å…©å¼µåœ–ç‰‡çš„å…§å®¹(åœ–A:äººå·¥éŠæ¨‚è¨­æ–½ vs åœ–B:è‡ªç„¶æ£®æ—å…¬åœ’),å¯«ä¸€ç¯‡è‹±æ–‡ä½œæ–‡,æ–‡åˆ†å…©æ®µã€‚ç¬¬ä¸€æ®µæè¿°åœ–Aå’Œåœ–Bä¸­çš„å…¬åœ’å„æœ‰ä½•ç‰¹è‰²,ç¬¬äºŒæ®µå‰‡èªªæ˜ä½ å¿ƒç›®ä¸­ç†æƒ³å…¬åœ’çš„æ¨£è²Œèˆ‡ç‰¹è‰²,ä¸¦è§£é‡‹ä½ çš„ç†ç”±ã€‚",
                    images: [
                        { 
                            src: "./park.png", 
                            label: "åœ– A & B", 
                            desc: "éŠæ¨‚å ´ vs æ£®æ—" 
                        }
                    ],
                    content: "The set of images presented offers a striking juxtaposition between artificial facilities and natural environments, highlighting the multifaceted nature of an ideal park. On one end of the spectrum, Image A captures a sense of lively energy. Here, we observe a colorful playground full of children, which suggests a perfect place for kids to play and have fun together. Conversely, Image B paints a starkly different picture, evoking an atmosphere of peace and quiet. Unlike the former, this scene is characterized by tall trees and a simple walking path, emphasizing the relaxing power of nature. The difference between these two scenarios is not merely visual but speaks to the deeper contrast of excitement versus relaxation.\n\nReflecting upon these distinct depictions, I find myself gravitating towards the peaceful forest shown in Image B. To me, a park represents more than just a place to exercise; it serves as a sanctuary for resting my mind. While playing on the swings holds some merit for physical health, it pales in comparison to the essential value of mental health provided by nature. For instance, I recall a moment when I felt extremely stressed after a difficult math exam. Instead of going to a noisy place, I took a walk in a quiet park nearby. The fresh air and the sound of birds quickly made me feel calm again. Ultimately, whether we are discussing public spaces or personal choices, the priority should undoubtedly be placed on comfort and peace, ensuring that people can truly recharge their batteries.",
                    translation: "é€™çµ„åœ–ç‰‡å‘ˆç¾äº†äººå·¥è¨­æ–½èˆ‡è‡ªç„¶ç’°å¢ƒä¹‹é–“çš„å¼·çƒˆå°æ¯”ï¼Œçªé¡¯äº†ç†æƒ³å…¬åœ’çš„å¤šé¢å‘æœ¬è³ªã€‚åœ¨å…‰è­œçš„ä¸€ç«¯ï¼Œåœ–ç‰‡Aæ•æ‰åˆ°äº†ä¸€ç¨®å……æ»¿æ´»åŠ›çš„èƒ½é‡ã€‚åœ¨é€™è£¡ï¼Œæˆ‘å€‘è§€å¯Ÿåˆ°ä¸€å€‹å……æ»¿å­©å­è‰²å½©ç¹½ç´›çš„éŠæ¨‚å ´ï¼Œé€™æš—ç¤ºè‘—ä¸€å€‹è®“å­©å­å€‘ä¸€èµ·ç©è€å’ŒåŒæ¨‚çš„å®Œç¾å ´æ‰€ã€‚ç›¸ååœ°ï¼Œåœ–ç‰‡Bæç¹ªäº†ä¸€å¹…æˆªç„¶ä¸åŒçš„ç•«é¢ï¼Œå–šèµ·äº†ä¸€ç¨®å¯§éœèˆ‡å¹³å’Œçš„æ°›åœã€‚èˆ‡å‰è€…ä¸åŒï¼Œé€™å€‹å ´æ™¯çš„ç‰¹å¾µæ˜¯é«˜è³çš„æ¨¹æœ¨å’Œä¸€æ¢ç°¡å–®çš„æ­¥é“ï¼Œå¼·èª¿äº†å¤§è‡ªç„¶çš„æ”¾é¬†åŠ›é‡ã€‚é€™å…©ç¨®æƒ…å¢ƒä¹‹é–“çš„å·®ç•°ä¸åƒ…æ˜¯è¦–è¦ºä¸Šçš„ï¼Œæ›´è¨´èªªäº†èˆˆå¥®èˆ‡æ”¾é¬†ä¹‹é–“æ›´æ·±å±¤çš„å°æ¯”ã€‚\n\nåæ€é€™äº›æˆªç„¶ä¸åŒçš„æç¹ªï¼Œæˆ‘ç™¼ç¾è‡ªå·±æ›´å‚¾å‘æ–¼åœ–ç‰‡Bä¸­å±•ç¤ºçš„å¯§éœæ£®æ—ã€‚å°æˆ‘ä¾†èªªï¼Œå…¬åœ’ä¸åƒ…åƒ…æ˜¯ä¸€å€‹é‹å‹•çš„åœ°æ–¹ï¼›å®ƒå……ç•¶äº†æˆ‘å¿ƒéˆä¼‘æ¯çš„é¿é¢¨æ¸¯ã€‚é›–ç„¶ç›ªé¦éŸ†å°èº«é«”å¥åº·æœ‰å…¶å„ªé»ï¼Œä½†èˆ‡å¤§è‡ªç„¶æä¾›çš„å¿ƒç†å¥åº·é€™ä¸€æœ¬è³ªåƒ¹å€¼ç›¸æ¯”ï¼Œå®ƒå°±ç›¸å½¢è¦‹çµ€äº†ã€‚ä¾‹å¦‚ï¼Œæˆ‘å›æƒ³èµ·æœ‰ä¸€æ¬¡æˆ‘åœ¨ç¶“æ­·äº†ä¸€å ´å›°é›£çš„æ•¸å­¸è€ƒè©¦å¾Œæ„Ÿåˆ°å£“åŠ›æ¥µå¤§ã€‚æˆ‘æ²’æœ‰å»åµé›œçš„åœ°æ–¹ï¼Œè€Œæ˜¯åœ¨é™„è¿‘çš„å®‰éœå…¬åœ’æ•£æ­¥ã€‚æ–°é®®çš„ç©ºæ°£å’Œé³¥é³´è²å¾ˆå¿«è®“æˆ‘å†æ¬¡æ„Ÿåˆ°å¹³éœã€‚æœ€çµ‚ï¼Œç„¡è«–æˆ‘å€‘è¨è«–çš„æ˜¯å…¬å…±ç©ºé–“é‚„æ˜¯å€‹äººé¸æ“‡ï¼Œå„ªå…ˆè€ƒé‡ç„¡ç–‘æ‡‰è©²æ”¾åœ¨èˆ’é©èˆ‡å¹³éœä¸Šï¼Œç¢ºä¿äººå€‘èƒ½å¤ çœŸæ­£åœ°å……é›»ã€‚"
                },
                {
                    id: 2,
                    title: "ç¯„æ–‡ 2: Typhoon Day",
                    prompt: "æç¤º: æ¯é€¢é¢±é¢¨é€¼è¿‘è‡ºç£,å„ç¸£å¸‚æ”¿åºœæœƒä¾æ°£è±¡é å ±çš„å…§å®¹è€Œæ±ºå®šéš”æ—¥æ˜¯å¦åœæ­¢ä¸Šç­ä¸Šèª²ã€‚è«‹é‡å°é€™å€‹è­°é¡Œå¯«ä¸€ç¯‡è‹±æ–‡ä½œæ–‡,æ–‡åˆ†å…©æ®µã€‚ç¬¬ä¸€æ®µæ ¹æ“šä¸‹æ–¹å°æ¯”åœ–ç‰‡(åœ–A:é›»å½±é™¢æ’éšŠäººæ½® vs åœ–B:é¢¨é›¨ä¸­é¨è»Š),æè¿°é¢±é¢¨å‡æ™‚,å¯¦éš›ä¸Šå¯èƒ½å‡ºç¾çš„å…©ç¨®ä¸åŒæƒ…æ™¯;ç¬¬äºŒæ®µèªªæ˜ä½ å°æ”¾é¢±é¢¨å‡çš„çœ‹æ³•èˆ‡ç¶“é©—ã€‚",
                    images: [
                        { 
                            src: "./typhoon.png", 
                            label: "åœ– A & B", 
                            desc: "é›»å½±é™¢ vs é¨å£«" 
                        }
                    ],
                    content: "The set of images presented offers a striking juxtaposition between enjoying a holiday and facing danger, highlighting the multifaceted nature of a typhoon day. On one end of the spectrum, Image A captures a sense of excitement and relaxation. Here, we observe crowds of people lining up at a movie theater, which suggests that many people treat the typhoon break simply as a bonus time to have fun. Conversely, Image B paints a starkly different picture, evoking an atmosphere of difficulty and risk. Unlike the former, this scene is characterized by motorcyclists struggling against strong winds and heavy rain, emphasizing how dangerous it is to be outside during the storm. The contrast between these two scenarios is not merely visual but speaks to the deeper dichotomy of personal pleasure versus public safety.\n\nReflecting upon these distinct depictions, I find myself gravitating towards the cautious attitude suggested by the reality of Image B. To me, a typhoon day represents more than just a free day off from school or work; it serves as a sanctuary for protecting our lives. While going shopping or watching a movie holds some merit for relieving stress, it pales in comparison to the essential value of staying safe indoors. For instance, I recall a moment when I ordered food delivery during a typhoon because I was lazy. When the delivery man arrived, he was soaking wet and shivering. I felt terrible because my convenience put him in danger. Ultimately, whether we are discussing government policy or personal choices, the priority should undoubtedly be placed on safety and empathy, ensuring that no one gets hurt unnecessarily.",
                    translation: "é€™çµ„åœ–ç‰‡å‘ˆç¾äº†äº«å—å‡æœŸèˆ‡é¢å°å±éšªä¹‹é–“çš„å¼·çƒˆå°æ¯”ï¼Œçªé¡¯äº†é¢±é¢¨å¤©å¤šé¢å‘çš„æœ¬è³ªã€‚åœ¨å…‰è­œçš„ä¸€ç«¯ï¼Œåœ–ç‰‡Aæ•æ‰åˆ°äº†ä¸€ç¨®èˆˆå¥®èˆ‡æ”¾é¬†çš„æ„Ÿè¦ºã€‚åœ¨é€™è£¡ï¼Œæˆ‘å€‘è§€å¯Ÿåˆ°é›»å½±é™¢å‰æ’éšŠçš„äººæ½®ï¼Œé€™æš—ç¤ºè‘—è¨±å¤šäººåƒ…åƒ…å°‡é¢±é¢¨å‡è¦–ç‚ºç©æ¨‚çš„é¡å¤–æ™‚é–“ã€‚ç›¸ååœ°ï¼Œåœ–ç‰‡Bæç¹ªäº†ä¸€å¹…æˆªç„¶ä¸åŒçš„ç•«é¢ï¼Œå–šèµ·äº†ä¸€ç¨®å›°é›£èˆ‡é¢¨éšªçš„æ°›åœã€‚èˆ‡å‰è€…ä¸åŒï¼Œé€™å€‹å ´æ™¯çš„ç‰¹å¾µæ˜¯æ©Ÿè»Šé¨å£«åœ¨å¼·é¢¨è±ªé›¨ä¸­æ™æ‰ï¼Œå¼·èª¿äº†æš´é¢¨é›¨æœŸé–“åœ¨æˆ¶å¤–æ˜¯å¤šéº¼å±éšªã€‚é€™å…©ç¨®æƒ…å¢ƒä¹‹é–“çš„å°æ¯”ä¸åƒ…æ˜¯è¦–è¦ºä¸Šçš„ï¼Œæ›´è¨´èªªäº†å€‹äººäº«æ¨‚èˆ‡å…¬å…±å®‰å…¨ä¹‹é–“æ›´æ·±å±¤çš„äºŒå…ƒå°ç«‹ã€‚\n\nåæ€é€™äº›æˆªç„¶ä¸åŒçš„æç¹ªï¼Œæˆ‘ç™¼ç¾è‡ªå·±æ›´å‚¾å‘æ–¼åœ–ç‰‡Bç¾å¯¦æ‰€æš—ç¤ºçš„è¬¹æ…æ…‹åº¦ã€‚å°æˆ‘ä¾†èªªï¼Œé¢±é¢¨å¤©ä¸åƒ…åƒ…æ˜¯ä¸ç”¨ä¸Šå­¸æˆ–ä¸Šç­çš„å…è²»å‡æœŸï¼›å®ƒå……ç•¶äº†ä¿è­·æˆ‘å€‘ç”Ÿå‘½çš„é¿é¢¨æ¸¯ï¼ˆä¿è­·æ©Ÿåˆ¶ï¼‰ã€‚é›–ç„¶å»è³¼ç‰©æˆ–çœ‹é›»å½±å°ç·©è§£å£“åŠ›æœ‰å…¶å„ªé»ï¼Œä½†èˆ‡å¾…åœ¨å®¤å…§ä¿æŒå®‰å…¨çš„æœ¬è³ªåƒ¹å€¼ç›¸æ¯”ï¼Œå®ƒå°±ç›¸å½¢è¦‹çµ€äº†ã€‚ä¾‹å¦‚ï¼Œæˆ‘å›æƒ³èµ·æœ‰ä¸€æ¬¡é¢±é¢¨å¤©æˆ‘å› ç‚ºæ‡¶æƒ°è€Œå«äº†å¤–é€ã€‚ç•¶å¤–é€å“¡åˆ°é”æ™‚ï¼Œä»–å…¨èº«æ¿•é€ä¸”åœ¨ç™¼æŠ–ã€‚æˆ‘æ„Ÿåˆ°éå¸¸ç³Ÿç³•ï¼Œå› ç‚ºæˆ‘çš„ä¾¿åˆ©è®“ä»–é™·å…¥å±éšªã€‚æœ€çµ‚ï¼Œç„¡è«–æˆ‘å€‘è¨è«–çš„æ˜¯æ”¿åºœæ”¿ç­–é‚„æ˜¯å€‹äººé¸æ“‡ï¼Œå„ªå…ˆè€ƒé‡ç„¡ç–‘æ‡‰è©²æ”¾åœ¨å®‰å…¨èˆ‡åŒç†å¿ƒä¸Šï¼Œç¢ºä¿æ²’æœ‰äººå—åˆ°ä¸å¿…è¦çš„å‚·å®³ã€‚"
                }
            ];

            // --- æ ¸å¿ƒå…ƒä»¶ ---

            const useAudioPlayer = (text) => {
                const [state, setState] = useState('idle');
                const synth = window.speechSynthesis;
                const utteranceRef = useRef(null);

                const getCleanText = (rawText) => {
                    return rawText.replace(/\[P\d+\]/g, '').replace(/\[\d+\]/g, '');
                };

                const stop = () => {
                    if (synth.speaking || synth.paused) {
                        synth.cancel();
                    }
                    setState('idle');
                };

                const play = () => {
                    stop();
                    const cleanText = getCleanText(text);
                    if (!cleanText) return;

                    const u = new SpeechSynthesisUtterance(cleanText);
                    u.lang = 'en-US'; 
                    u.rate = 0.9;
                    
                    u.onstart = () => setState('playing');
                    u.onend = () => setState('idle');
                    u.onerror = (e) => {
                        console.error("Speech Error:", e);
                        setState('idle');
                    };

                    utteranceRef.current = u;

                    // --- è²éŸ³é¸æ“‡é‚è¼¯ (å„ªåŒ–ç‰ˆ) ---
                    const voices = synth.getVoices();
                    
                    // å„ªå…ˆé †åºï¼šGoogleå°å§ -> Edgeè¶…è‡ªç„¶èªéŸ³ -> ä¸€èˆ¬ç¾å¼è‹±æ–‡
                    const preferredVoice = 
                        voices.find(v => v.name.includes("Google US English")) || 
                        voices.find(v => v.name.includes("Natural") && v.lang.includes("en-US")) ||
                        voices.find(v => v.lang === 'en-US');

                    if (preferredVoice) {
                        u.voice = preferredVoice;
                        // Edge çš„ Natural è²éŸ³é€šå¸¸æ¯”è¼ƒæ…¢ä¸”æ¸…æ¥šï¼Œç¨å¾®èª¿å›æ¨™æº–é€Ÿåº¦æœƒæ›´è‡ªç„¶
                        if (preferredVoice.name.includes("Natural")) {
                            u.rate = 1.0; 
                        }
                    }
                    // ---------------------------

                    synth.speak(u);
                };

                const pause = () => {
                    if (synth.speaking && !synth.paused) {
                        synth.pause();
                        setState('paused');
                    }
                };

                const resume = () => {
                    if (synth.paused) {
                        synth.resume();
                        setState('playing');
                    } else {
                        play();
                    }
                };

                useEffect(() => {
                    const loadVoices = () => { window.speechSynthesis.getVoices(); };
                    window.speechSynthesis.onvoiceschanged = loadVoices;
                    loadVoices();
                    return () => stop();
                }, []);

                return { state, play, pause, resume, stop };
            };

            const AudioControl = ({ text }) => {
                const { state, play, pause, resume, stop } = useAudioPlayer(text);
                
                return (
                    <div className="flex items-center gap-2 mb-3">
                        <button onClick={state === 'playing' ? pause : (state === 'paused' ? resume : play)} 
                            className={`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-bold transition-all ${state === 'playing' ? 'bg-blue-100 text-blue-600 ring-2 ring-blue-200' : 'bg-white border border-gray-200 text-gray-600 hover:bg-gray-50'}`}>
                            {state === 'playing' ? <Icons.Pause /> : <Icons.Play />}
                            {state === 'playing' ? 'æš«åœæœ—è®€' : (state === 'paused' ? 'ç¹¼çºŒæœ—è®€' : 'å…¨æ–‡æœ—è®€')}
                        </button>
                        {(state === 'playing' || state === 'paused') && (
                             <button onClick={stop} className="p-2 text-gray-400 hover:text-red-500 bg-white border border-gray-200 rounded-full">
                                <Icons.Square />
                             </button>
                        )}
                    </div>
                )
            };

            const BottomSheet = ({ data, type, onClose, isQuizMode }) => {
                const { state, play, pause, resume, stop } = useAudioPlayer(type === 'vocab' ? `${data.word}. ${data.ex}` : '');
                const [isRevealed, setIsRevealed] = useState(false);

                useEffect(() => { setIsRevealed(false); return () => stop(); }, [data.id || data.word]);
                const showHidden = isQuizMode && type === 'vocab' && !isRevealed;

                return (
                    <div className="fixed inset-0 z-50 flex items-end justify-center pointer-events-none">
                        <div className="absolute inset-0 bg-black/40 animate-fade-in pointer-events-auto" onClick={onClose}></div>
                        <div className="bg-white w-full rounded-t-2xl p-6 pb-12 shadow-[0_-5px_20px_rgba(0,0,0,0.15)] animate-slide-up pointer-events-auto relative max-h-[80vh] overflow-y-auto">
                            <div className="w-12 h-1.5 bg-gray-200 rounded-full mx-auto mb-6"></div>
                            <button onClick={onClose} className="absolute top-4 right-4 text-gray-400 p-2"><Icons.X /></button>

                            <div className="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2">
                                {type === 'vocab' ? 'Vocabulary' : 'Formula Examples'}
                            </div>

                            {type === 'footnote' && (
                                <div className="space-y-3">
                                    {data.map((ex, i) => (
                                        <div key={i} className="p-3 bg-blue-50 rounded-lg text-base text-gray-800 border-l-4 border-blue-400">
                                            {ex}
                                        </div>
                                    ))}
                                </div>
                            )}

                            {type === 'vocab' && showHidden && (
                                <div className="text-center py-6">
                                    <div className="text-gray-500 mb-2">{data.pos}</div>
                                    <div className="font-bold text-xl mb-6">{data.def}</div>
                                    <button onClick={() => setIsRevealed(true)}
                                        className="flex items-center justify-center gap-2 w-full py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 font-bold shadow-lg shadow-blue-200 active:scale-95 transition-transform">
                                        <Icons.Eye /> æ­æ›‰ç­”æ¡ˆ
                                    </button>
                                </div>
                            )}

                            {type === 'vocab' && !showHidden && (
                                <div>
                                    <div className="flex justify-between items-end mb-2">
                                        <h3 className="text-3xl font-bold text-gray-900 leading-none">{data.word}</h3>
                                        <span className="font-mono text-gray-500">{data.kk}</span>
                                    </div>
                                    <div className="flex items-center gap-2 mb-6">
                                        <span className="text-xs font-bold bg-gray-100 px-2 py-1 rounded text-gray-600">{data.pos}</span>
                                        <span className="text-lg text-gray-800 font-medium">{data.def}</span>
                                    </div>
                                    <div className="flex items-center gap-3 mb-6 bg-gray-50 p-2 pr-4 rounded-full w-max border border-gray-100">
                                        <button onClick={state === 'playing' ? pause : (state === 'paused' ? resume : play)} 
                                            className="w-10 h-10 flex items-center justify-center bg-white shadow rounded-full text-blue-600 active:bg-gray-50">
                                            {state === 'playing' ? <Icons.Pause /> : <Icons.Play />}
                                        </button>
                                        <button onClick={stop} className="p-2 text-gray-400 hover:text-red-500"><Icons.Square /></button>
                                        <div className="h-4 w-[1px] bg-gray-300 mx-1"></div>
                                        <span className="text-xs font-medium text-blue-900">
                                            {state === 'playing' ? 'Playing...' : 'Listen'}
                                        </span>
                                    </div>
                                    <div className="text-base text-gray-600 italic border-l-2 border-gray-300 pl-3 leading-relaxed">
                                        "{data.ex}"
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                );
            };

            const TextParser = ({ text, onActivate, activeId, isQuizMode }) => {
                const parts = text.split(/(\[\d+\]|[\u4e00-\u9fa5]+[a-zA-Z0-9\(\)\/]*|[\s\.,;!?()]+)/g).filter(Boolean);

                return (
                    <p className="leading-relaxed text-[17px] text-gray-800 font-normal tracking-wide">
                        {parts.map((part, index) => {
                            // Footnote
                            if (/^\[\d+\]$/.test(part)) {
                                const id = parseInt(part.replace(/[\[\]]/g, ''));
                                return (
                                    <button key={index} 
                                        onClick={(e) => { e.stopPropagation(); onActivate('footnote', id); }}
                                        className="inline-flex items-center justify-center min-w-[18px] h-[18px] ml-1 align-top text-[10px] font-bold bg-[#EB5757]/10 text-[#EB5757] rounded active:bg-[#EB5757] active:text-white transition-colors">
                                        {id}
                                    </button>
                                );
                            }
                            // Chinese Placeholder
                            if (/[\u4e00-\u9fa5]/.test(part)) {
                                return <span key={index} className="text-gray-400 mx-1 border-b border-dashed border-gray-300">{part}</span>;
                            }
                            // Vocab Check
                            const lower = part.toLowerCase();
                            if (VOCAB_DB[lower]) {
                                const isActive = activeId === `vocab-${lower}`;
                                if (isQuizMode) {
                                    return (
                                        <span key={index} onClick={(e) => { e.stopPropagation(); onActivate('vocab', lower); }}
                                            className="border-b-2 border-[#EB5757] bg-[#EB5757]/5 px-1 mx-0.5 text-transparent active:bg-[#EB5757]/20 transition-colors cursor-pointer">
                                            {part}
                                        </span>
                                    );
                                }
                                return (
                                    <span key={index} onClick={(e) => { e.stopPropagation(); onActivate('vocab', lower); }}
                                        className={`px-1 mx-0.5 rounded transition-colors cursor-pointer ${isActive ? 'bg-blue-200 text-blue-900' : 'bg-[#E3E2E0] active:bg-blue-100'}`}>
                                        {part}
                                    </span>
                                );
                            }
                            return <span key={index}>{part}</span>;
                        })}
                    </p>
                );
            };

            const EssayCard = ({ essay, onActivate, activePopoverKey, isQuizMode }) => {
                const [showTrans, setShowTrans] = useState(false);
                // å–®åœ–æ»¿ç‰ˆ (å› ç‚ºä½¿ç”¨è€…æä¾›çš„åœ–æ˜¯ A/B åˆä½µ)
                const gridClass = "grid grid-cols-1 mb-6";

                return (
                    <div>
                        <h2 className="text-xl font-bold mb-2 text-gray-900 leading-tight">
                            {essay.title}
                        </h2>
                        
                        <div className="bg-gray-100 p-3 rounded-lg mb-4 text-sm text-gray-600 leading-relaxed border-l-4 border-gray-300">
                            {essay.prompt}
                        </div>

                        {/* åœ–ç‰‡å€å¡Š */}
                        {essay.images && (
                            <div className={gridClass}>
                                {essay.images.map((img, i) => (
                                    <div key={i} className="relative group">
                                        <div className="aspect-[16/9] rounded-lg overflow-hidden bg-gray-200 shadow-sm border border-gray-200">
                                            <img src={img.src} alt={img.label} className="w-full h-full object-contain bg-white" />
                                        </div>
                                        {/* åœ–ç‰‡æ¨™ç±¤ */}
                                        <div className="absolute top-2 left-2 bg-black/60 backdrop-blur-sm text-white px-2 py-0.5 rounded text-[10px] font-bold tracking-wider">
                                            {img.label}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                        
                        <AudioControl text={essay.content} />

                        <div className="mb-4">
                            <TextParser text={essay.content} onActivate={onActivate} activeId={activePopoverKey} isQuizMode={isQuizMode} />
                        </div>

                        <button 
                            onClick={() => setShowTrans(!showTrans)}
                            className="flex items-center gap-1.5 text-xs font-bold text-gray-500 bg-gray-100 hover:bg-gray-200 px-3 py-2 rounded-full transition-colors mb-4">
                            <Icons.Translate />
                            {showTrans ? 'éš±è—ä¸­æ–‡ç¿»è­¯' : 'æŸ¥çœ‹ä¸­æ–‡ç¿»è­¯'}
                            {showTrans ? <Icons.ChevronUp /> : <Icons.ChevronDown />}
                        </button>

                        {showTrans && (
                            <div className="bg-[#F3F4F6] p-4 rounded-xl text-[15px] leading-relaxed text-gray-700 animate-fade-in border border-gray-200">
                                {essay.translation.split('\n\n').map((p, i) => (
                                    <p key={i} className={i > 0 ? 'mt-4' : ''}>{p}</p>
                                ))}
                            </div>
                        )}
                        
                        <div className="h-px bg-gray-100 my-8"></div>
                    </div>
                );
            };

            const App = () => {
                const [activeTab, setActiveTab] = useState('formula');
                const [activePopover, setActivePopover] = useState(null); 
                const [isQuizMode, setIsQuizMode] = useState(false);

                const handleActivate = (type, id) => setActivePopover({ type, id, key: `${type}-${id}` });
                const closePopover = () => setActivePopover(null);

                return (
                    <div className="flex flex-col h-full bg-white relative">
                        
                         {/* é ‚éƒ¨é–ƒçˆæç¤º */}
                        <div className="shrink-0 bg-green-600 text-white text-xs font-bold text-center py-1.5 z-50">
                             <span className="animate-pulse">ğŸ“¢ æœ—è®€åŠŸèƒ½å·²ä¿®å¾©</span>
                        </div>

                        {/* Header */}
                        <div className="bg-white/90 backdrop-blur border-b border-gray-200 px-4 py-3 flex justify-between items-center z-20 shrink-0 safe-top gap-3">
                            <div className="font-bold text-base text-gray-800 truncate flex-1">
                                è¬ç”¨ä½œæ–‡æ¨¡æ¿ï¼šé›™åœ–å°æ¯”ç‰ˆ
                            </div>
                            
                            <div className="flex items-center gap-2 bg-gray-100 rounded-full pl-3 pr-2 py-1 cursor-pointer shrink-0" onClick={() => setIsQuizMode(!isQuizMode)}>
                                <span className={`text-[10px] font-bold tracking-wider ${!isQuizMode ? 'text-blue-600' : 'text-gray-400'}`}>
                                    STUDY
                                </span>
                                <div className="transition-colors text-gray-400">
                                    {isQuizMode ? <Icons.ToggleRight /> : <Icons.ToggleLeft />}
                                </div>
                                <span className={`text-[10px] font-bold tracking-wider ${isQuizMode ? 'text-[#EB5757]' : 'text-gray-400'}`}>
                                    QUIZ
                                </span>
                            </div>
                        </div>

                        {/* Content */}
                        <div className="flex-1 overflow-y-auto overflow-x-hidden pb-24 px-5 pt-6 hide-scrollbar bg-white">
                            {activeTab === 'formula' && (
                                <div className="animate-fade-in">
                                    <div className="mb-8 bg-blue-50/80 p-4 rounded-xl border border-blue-100">
                                        <div className="text-xs font-bold text-blue-400 uppercase tracking-widest mb-2">Instructions</div>
                                        <div className="space-y-2 text-sm text-blue-900">
                                            <p><span className="font-bold">Step 1:</span> é–±è®€æ¨£æ¿ (ä¸ç”¨èƒŒæ¨£æ¿)</p>
                                            <p><span className="font-bold">Step 2:</span> é–±è®€ç¯„æ–‡</p>
                                            <div>
                                                <span className="font-bold">Step 3:</span> <span className="underline decoration-blue-300">å…¨æ–‡èƒŒèª¦</span>ä¸€ç¯‡ç¯„æ–‡
                                                <div className="mt-1 text-xs text-blue-600 font-medium bg-blue-100/50 p-2 rounded">
                                                    â­ ç¯„æ–‡æœ‰ä¸Šä¸‹æ–‡ï¼Œæ¯”å…¬å¼å¥½èƒŒï¼ŒèƒŒç†Ÿå¾Œè‡ªç„¶èƒ½éˆæ´»é‹ç”¨ã€‚
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <h2 className="text-2xl font-bold mb-6 text-gray-900">è¬ç”¨ä½œæ–‡æ¨¡ç‰ˆ</h2>
                                    {FORMULA_PARAGRAPHS.map((para, i) => (
                                        <div key={i}>
                                            <AudioControl text={para} />
                                            <TextParser text={para} onActivate={handleActivate} activeId={activePopover?.key} isQuizMode={isQuizMode} />
                                            {i < FORMULA_PARAGRAPHS.length - 1 && <div className="h-6"></div>}
                                        </div>
                                    ))}
                                </div>
                            )}

                            {activeTab === 'essays' && (
                                <div className="animate-fade-in space-y-12">
                                    {ESSAYS_DATA.map(essay => (
                                        <EssayCard 
                                            key={essay.id} 
                                            essay={essay} 
                                            onActivate={handleActivate} 
                                            activePopoverKey={activePopover?.key} 
                                            isQuizMode={isQuizMode} 
                                        />
                                    ))}
                                </div>
                            )}
                        </div>

                        {/* Nav */}
                        <nav className="shrink-0 bg-white border-t border-gray-200 safe-bottom pb-safe z-30">
                            <div className="flex justify-around items-center h-16">
                                <button onClick={() => setActiveTab('formula')} 
                                    className={`flex flex-col items-center justify-center w-full h-full space-y-1 ${activeTab === 'formula' ? 'text-blue-600' : 'text-gray-400'}`}>
                                    <Icons.Book />
                                    <span className="text-[10px] font-medium">æ¨£æ¿</span>
                                </button>
                                <button onClick={() => setActiveTab('essays')} 
                                    className={`flex flex-col items-center justify-center w-full h-full space-y-1 ${activeTab === 'essays' ? 'text-blue-600' : 'text-gray-400'}`}>
                                    <Icons.FileText />
                                    <span className="text-[10px] font-medium">ç¯„æ–‡</span>
                                </button>
                            </div>
                        </nav>

                        {/* Popover */}
                        {activePopover && (
                            <BottomSheet 
                                data={activePopover.type === 'vocab' 
                                    ? { ...VOCAB_DB[activePopover.id], word: activePopover.id } 
                                    : FOOTNOTE_DB[activePopover.id]} 
                                type={activePopover.type} 
                                onClose={closePopover} 
                                isQuizMode={isQuizMode} 
                            />
                        )}
                    </div>
                );
            };

            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(<App />);
        } catch (err) {
            document.getElementById('error-display').style.display = 'block';
            document.getElementById('error-display').innerHTML = 
                '<h3>âš ï¸ React æ¸²æŸ“éŒ¯èª¤</h3>' +
                '<p>' + err.toString() + '</p>';
        }
    </script>
</body>
</html>
